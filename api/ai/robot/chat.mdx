---
title: "POST AI机器人对话"
openapi: "POST /api/v1/robot/chat"
---

## 概述

与 AI 机器人进行对话交互。

<div style={{ marginTop: 24, marginBottom: 24 }}>
  <ApiPlayground
    method="POST"
    endpoint="/api/v1/robot/chat"
  />
</div>

## 接口说明

此接口用于与 AI 机器人进行对话。支持多轮对话，会自动维护对话上下文。

## 请求头

```
Authorization: Bearer <access_token>
Content-Type: application/json
```

## 请求体

```json
{
  "robotUid": "robot_123456",
  "threadUid": "thread_123456",
  "content": "你好，请问如何使用这个产品？",
  "stream": false
}
```

## 字段说明

### 请求字段

- `robotUid` (必需): 机器人唯一标识符
- `threadUid` (可选): 会话唯一标识符，首次对话可不传，后续对话需要传入
- `content` (必需): 用户消息内容
- `stream` (可选): 是否使用流式响应，默认 false

### 响应字段（非流式）

- `threadUid`: 会话唯一标识符
- `message`: AI 回复消息对象
  - `uid`: 消息唯一标识符
  - `content`: 消息内容
  - `createdAt`: 创建时间
- `usage`: Token 使用情况
  - `promptTokens`: 提示 token 数
  - `completionTokens`: 完成 token 数
  - `totalTokens`: 总 token 数

### 响应字段（流式）

返回 SSE (Server-Sent Events) 流，每个事件包含消息片段。

## 使用场景

- 智能客服对话
- AI 问答
- 多轮对话
- 流式对话体验

## 注意事项

- 首次对话可不传 threadUid，系统会自动创建
- 后续对话需要传入 threadUid 以保持上下文
- 流式响应适合长文本回复场景
- 会话有超时机制，超时后需要重新开始

<ResponseExample>

```json 200 成功响应（非流式）
{
  "code": 200,
  "message": "success",
  "data": {
    "threadUid": "thread_123456",
    "message": {
      "uid": "msg_123456",
      "content": "您好！欢迎使用我们的产品。以下是使用指南：...",
      "createdAt": "2025-01-07T10:30:00Z"
    },
    "usage": {
      "promptTokens": 150,
      "completionTokens": 200,
      "totalTokens": 350
    }
  }
}
```

```json 400 机器人不存在
{
  "code": 400,
  "message": "Robot not found",
  "data": null
}
```

```json 400 机器人未启用
{
  "code": 400,
  "message": "Robot is not enabled",
  "data": null
}
```

</ResponseExample>

<RequestExample>

```bash cURL
# 非流式对话
curl -X POST "https://api.weiyuai.cn/api/v1/robot/chat" \
  -H "Authorization: Bearer your_access_token_here" \
  -H "Content-Type: application/json" \
  -d '{
    "robotUid": "robot_123456",
    "content": "你好，请问如何使用这个产品？",
    "stream": false
  }'

# 流式对话
curl -X POST "https://api.weiyuai.cn/api/v1/robot/chat" \
  -H "Authorization: Bearer your_access_token_here" \
  -H "Content-Type: application/json" \
  -d '{
    "robotUid": "robot_123456",
    "threadUid": "thread_123456",
    "content": "还有其他问题",
    "stream": true
  }'
```

```javascript JavaScript
// 非流式对话
async function chatWithRobot(robotUid, content, threadUid = null) {
  const response = await fetch('https://api.weiyuai.cn/api/v1/robot/chat', {
    method: 'POST',
    headers: {
      'Authorization': 'Bearer your_access_token_here',
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      robotUid,
      content,
      threadUid,
      stream: false
    })
  });

  const result = await response.json();
  return result.data;
}

// 使用示例
const result = await chatWithRobot('robot_123456', '你好');
console.log(result.message.content);
console.log('会话ID:', result.threadUid);

// 继续对话
const followUp = await chatWithRobot('robot_123456', '还有其他问题吗？', result.threadUid);
```

```python Python
import requests

def chat_with_robot(robot_uid, content, thread_uid=None):
    url = "https://api.weiyuai.cn/api/v1/robot/chat"
    headers = {
      "Authorization": "Bearer your_access_token_here",
      "Content-Type": "application/json"
    }

    data = {
      "robotUid": robot_uid,
      "content": content,
      "stream": False
    }

    if thread_uid:
        data["threadUid"] = thread_uid

    response = requests.post(url, headers=headers, json=data)
    result = response.json()
    return result["data"]

# 使用示例
result = chat_with_robot("robot_123456", "你好")
print(result["message"]["content"])
print("会话ID:", result["threadUid"])

# 继续对话
follow_up = chat_with_robot("robot_123456", "还有其他问题吗？", result["threadUid"])
```

</RequestExample>
