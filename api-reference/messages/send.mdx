---
title: "POST 发送消息"
openapi: "POST /messages"
---

在指定会话中发送消息，支持文本、图片、文件等多种消息类型。

## 接口说明

此接口用于在已存在的会话中发送消息，用户可以发送不同类型的内容与其他参与者进行沟通。

## 请求头

```
Authorization: Bearer <access_token>
```

## 请求体

```json
{
  "threadId": "string",
  "type": "string", 
  "content": "string"
}
```

### 参数说明

- `threadId` (必需): 目标会话的 ID
- `type` (必需): 消息类型
  - `TEXT`: 文本消息
  - `IMAGE`: 图片消息
  - `FILE`: 文件消息
- `content` (必需): 消息内容
  - 文本消息：直接的文本内容
  - 图片消息：图片的 URL 或 base64 编码
  - 文件消息：文件的 URL 或相关信息

## 响应示例

### 成功响应 (200)

```json
{
  "id": "msg_789012",
  "threadId": "thread_123456",
  "senderId": "user_123456",
  "type": "TEXT",
  "content": "你好，这是一条测试消息",
  "createdAt": "2023-01-04T12:30:00Z"
}
```

### 错误响应 (400)

```json
{
  "error": 400,
  "message": "Thread not found or access denied"
}
```

## 字段说明

- `id`: 消息唯一标识符
- `threadId`: 所属会话 ID
- `senderId`: 发送者用户 ID
- `type`: 消息类型
- `content`: 消息内容
- `createdAt`: 消息发送时间

## 消息类型详解

### TEXT（文本消息）
```json
{
  "threadId": "thread_123456",
  "type": "TEXT",
  "content": "Hello, world!"
}
```

### IMAGE（图片消息）
```json
{
  "threadId": "thread_123456",
  "type": "IMAGE", 
  "content": "https://api.weiyuai.cn/images/photo.jpg"
}
```

### FILE（文件消息）
```json
{
  "threadId": "thread_123456",
  "type": "FILE",
  "content": "{\"url\":\"https://api.weiyuai.cn/files/document.pdf\",\"name\":\"report.pdf\",\"size\":1024000}"
}
```

## 使用场景

- 即时聊天通讯
- 客服对话交流
- 群组讨论发言
- 文件共享传输

## 注意事项

- 需要有会话的发送权限
- 图片和文件需要先上传获得 URL
- 消息发送后不可修改
- 系统可能对消息内容进行审核

<RequestExample>

```bash cURL
curl -X POST "https://api.weiyuai.cn/api/v1/messages" \
  -H "Authorization: Bearer your_access_token_here" \
  -H "Content-Type: application/json" \
  -d '{
    "threadId": "thread_123456",
    "type": "TEXT",
    "content": "你好，这是一条测试消息"
  }'
```

```javascript JavaScript
const response = await fetch('https://api.weiyuai.cn/api/v1/messages', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer your_access_token_here',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    threadId: 'thread_123456',
    type: 'TEXT',
    content: '你好，这是一条测试消息'
  })
});

const message = await response.json();
```

```python Python
import requests

url = "https://api.weiyuai.cn/api/v1/messages"
headers = {
    "Authorization": "Bearer your_access_token_here",
    "Content-Type": "application/json"
}
data = {
    "threadId": "thread_123456",
    "type": "TEXT",
    "content": "你好，这是一条测试消息"
}

response = requests.post(url, headers=headers, json=data)
message = response.json()
```

</RequestExample>