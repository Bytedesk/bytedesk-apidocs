---
title: "POST 发送消息"
openapi: "POST /messages"
---

<div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>
  <div>
    <h1 style={{ margin: 0 }}>发送消息</h1>
    <p style={{ margin: '8px 0 0 0', color: '#6B7280' }}>在指定会话中发送消息，支持文本、图片、文件等多种消息类型</p>
  </div>
  <button 
    onClick={() => {
      const modal = document.createElement('div');
      modal.innerHTML = `
        <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; display: flex; justify-content: center; align-items: center;">
          <div style="background: white; padding: 20px; border-radius: 8px; width: 80%; max-width: 1000px; height: 80%; overflow-y: auto;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
              <h2>Try API - 发送消息</h2>
              <button onclick="this.closest('.modal-overlay').remove()" style="background: none; border: none; font-size: 24px; cursor: pointer;">&times;</button>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; height: calc(100% - 60px);">
              <div>
                <h3>Request</h3>
                <div style="margin-bottom: 15px;">
                  <label style="display: block; margin-bottom: 5px; font-weight: bold;">Authorization</label>
                  <input type="text" placeholder="Bearer <token>" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;" id="auth-header">
                </div>
                <div style="margin-bottom: 15px;">
                  <label style="display: block; margin-bottom: 5px; font-weight: bold;">threadId (required)</label>
                  <input type="text" placeholder="thread_123456" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;" id="thread-id">
                </div>
                <div style="margin-bottom: 15px;">
                  <label style="display: block; margin-bottom: 5px; font-weight: bold;">type (required)</label>
                  <select style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;" id="message-type">
                    <option value="TEXT">TEXT</option>
                    <option value="IMAGE">IMAGE</option>
                    <option value="FILE">FILE</option>
                  </select>
                </div>
                <div style="margin-bottom: 15px;">
                  <label style="display: block; margin-bottom: 5px; font-weight: bold;">content (required)</label>
                  <textarea placeholder="消息内容" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; height: 100px;" id="message-content"></textarea>
                </div>
                <button onclick="sendTestRequest()" style="background: #16A34A; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer;">Send Request</button>
              </div>
              <div>
                <h3>Response</h3>
                <div style="background: #f8f9fa; border: 1px solid #ddd; border-radius: 4px; padding: 15px; height: 400px; overflow-y: auto;" id="response-area">
                  点击 "Send Request" 查看响应结果
                </div>
              </div>
            </div>
          </div>
        </div>
      `;
      modal.className = 'modal-overlay';
      document.body.appendChild(modal);
      
      window.sendTestRequest = async function() {
        const auth = document.getElementById('auth-header').value;
        const threadId = document.getElementById('thread-id').value;
        const type = document.getElementById('message-type').value;
        const content = document.getElementById('message-content').value;
        const responseArea = document.getElementById('response-area');
        
        if (!auth || !threadId || !content) {
          responseArea.innerHTML = '<div style="color: red;">请填写所有必需字段</div>';
          return;
        }
        
        responseArea.innerHTML = '<div>发送请求中...</div>';
        
        try {
          const response = await fetch('https://api.weiyuai.cn/api/v1/messages', {
            method: 'POST',
            headers: {
              'Authorization': auth,
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              threadId: threadId,
              type: type,
              content: content
            })
          });
          
          const data = await response.json();
          responseArea.innerHTML = '<pre style="margin: 0; white-space: pre-wrap;">' + JSON.stringify(data, null, 2) + '</pre>';
        } catch (error) {
          responseArea.innerHTML = '<div style="color: red;">请求失败: ' + error.message + '</div>';
        }
      };
    }}
    style={{
      background: '#16A34A',
      color: 'white',
      border: 'none',
      padding: '8px 16px',
      borderRadius: '6px',
      cursor: 'pointer',
      fontSize: '14px',
      fontWeight: '500'
    }}
  >
    Try it →
  </button>
</div>

## 接口说明

此接口用于在已存在的会话中发送消息，用户可以发送不同类型的内容与其他参与者进行沟通。

## 请求参数

### Headers

| 参数名 | 类型 | 必需 | 说明 |
|--------|------|------|------|
| Authorization | string | ✓ | Bearer Token 认证 |
| Content-Type | string | ✓ | application/json |

### Body Parameters

| 参数名 | 类型 | 必需 | 说明 |
|--------|------|------|------|
| threadId | string | ✓ | 目标会话的 ID |
| type | string | ✓ | 消息类型：TEXT/IMAGE/FILE |
| content | string | ✓ | 消息内容 |

## 响应示例

### 成功响应 (200)

```json
{
  "id": "msg_789012",
  "threadId": "thread_123456",
  "senderId": "user_123456",
  "type": "TEXT",
  "content": "你好，这是一条测试消息",
  "createdAt": "2023-01-04T12:30:00Z"
}
```

### 错误响应 (400)

```json
{
  "error": 400,
  "message": "Thread not found or access denied"
}
```

## 字段说明

- `id`: 消息唯一标识符
- `threadId`: 所属会话 ID
- `senderId`: 发送者用户 ID
- `type`: 消息类型
- `content`: 消息内容
- `createdAt`: 消息发送时间

## 消息类型详解

### TEXT（文本消息）
```json
{
  "threadId": "thread_123456",
  "type": "TEXT",
  "content": "Hello, world!"
}
```

### IMAGE（图片消息）
```json
{
  "threadId": "thread_123456",
  "type": "IMAGE", 
  "content": "https://api.weiyuai.cn/images/photo.jpg"
}
```

### FILE（文件消息）
```json
{
  "threadId": "thread_123456",
  "type": "FILE",
  "content": "{\"url\":\"https://api.weiyuai.cn/files/document.pdf\",\"name\":\"report.pdf\",\"size\":1024000}"
}
```

## 使用场景

- 即时聊天通讯
- 客服对话交流
- 群组讨论发言
- 文件共享传输

## 注意事项

- 需要有会话的发送权限
- 图片和文件需要先上传获得 URL
- 消息发送后不可修改
- 系统可能对消息内容进行审核

<RequestExample>

```bash cURL
curl --request POST \
  --url https://api.weiyuai.cn/api/v1/messages \
  --header 'Authorization: Bearer <token>' \
  --header 'Content-Type: application/json' \
  --data '{
    "threadId": "thread_123456",
    "type": "TEXT",
    "content": "你好，这是一条测试消息"
  }'
```

```javascript JavaScript
const response = await fetch('https://api.weiyuai.cn/api/v1/messages', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer <token>',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    threadId: 'thread_123456',
    type: 'TEXT',
    content: '你好，这是一条测试消息'
  })
});

const data = await response.json();
```

```python Python
import requests

response = requests.post(
    'https://api.weiyuai.cn/api/v1/messages',
    headers={
        'Authorization': 'Bearer <token>',
        'Content-Type': 'application/json'
    },
    json={
        'threadId': 'thread_123456',
        'type': 'TEXT',
        'content': '你好，这是一条测试消息'
    }
)
```

</RequestExample>